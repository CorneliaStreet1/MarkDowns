### 20

```java
Link A-R1 :
Length: 900 + 20 (TCP) + 20 (IP) = 940 Bytes, ID:X , DF:0 , MF:0 , Fragment offset:0
Link R1-R2:
(1) Length = 500; ID = x; DF = 0; MF = 1; Offset = 0 (2) Length = 460; ID = x; DF = 0; MF = 0; Offset = 60
Link R2-B:
(1) Length = 500; ID = x; DF = 0; MF = 1; Offset = 0 (2) Length = 460; ID = x; DF = 0; MF = 0; Offset = 60
不用去考虑数据链路层的成帧部分，IP协议不关心。
```

### 21

- IP包的ID字段拥有16位，因此65536个不同编号，65536 ＊ 1024 * 8 / 10 = 54 Gbps

### 29

- Strict Source Routing 严格源路由，是IPv4头的可选项，表明该包必须经过指定路由。必须要在每个fragment都要包括。

### 30



```java
135.46.001110|00.0	Interface0
135.46.001111|00.0	Interface1
192.53.0010100|0.0	Router1
default             Router2
```

- (a)：135.46.001111|11.10：Interface1
- (b)：135.46.001110|01.14：Interface0
- (c)：135.46.001101|00.2：default，Router2
- (d)：192.53.0010100|0.7：Router1
- (e)：192.53.0011100|0：default，Router2

### 31

- 安装NAT后，与单个连接相关的所有数据包必须通过同一路由器进出公司，因为这是保持映射的地方。如果每个路由器都有自己的IP地址，并且属于给定连接的所有流量都可以发送到同一个路由器，则可以正确地进行映射，并且可以使用NAT进行多宿主。

### 34

- 超时后到达的最后一段也会被扔掉

### 35

- 其他部分的checksum可以交给上层协议，而且开销太大，此外头的错误非常严重。

### 38

- 因为在IPv6头中有一个字段叫下一个头，会说明该字段要交给哪一种上层协议处理。

### 39

- IP地址需要更长的空间，没有其他改变

### 补充题

### 1)

- $2^7 = 128$，每个局域网需要不少于120个地址。假定不去保留某些特殊的地址
- 可以给局域网1：202.118.1.0-202.118.1.119
- 局域网2:202.118.1.120-202.118.1.239

### 2)

- R1的路由：

  - ```java
    到局域网1:E1
    到局域网2:E2
    到域名服务器:R2(L0)202.118.2.2
    到互联网:R2(L0)202.118.2.2
    ```

- 路由聚合：202.118.1.x



### 2

00110001

- 50个主机，只需要6位地址码，因此LAN1，地址的最后一个字节的低6位是主机
- 60也6位地址码，LAN2地址的最后一个字节的低6位是主机
- 100需要七位地址码。LAN3地址的最后一个字节的最高位是属于网络部分。

```java
		网络地址（最后一个字节的网络和主机部分使用了竖线分隔开，写成了二进制）	最后一个可用地址		子网掩码
LAN1:	192.168.2.00|000000(0)-192.168.2.00|110001(49)				192.168.2.00|110001(49)		255.255.255.192
LAN2:	192.168.2.01|000000(64)-192.168.2.01|111011(123)			192.168.2.01|111011(59)		255.255.255.192
LAN3:	192.168.2.1|0000000(128)-192.168.2.1|1100011(227)			192.168.2.1|1100011(227)	
```

